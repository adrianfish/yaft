<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  
      xmlns="http://www.w3.org/1999/xhtml"  
      xml:lang="${isoLanguage}"
      lang="${isoLanguage}">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript">

    var yaft = {
        startupArgs: {
            userId: '$!{userId}',
            siteId: '$!{siteId}',
            placementId: '$!{placementId}',
            state: '$!{state}',
            editor: '$!{editor}',
            forumId: '$!{forumId}',
            viewMode: '$!{viewMode}',
            discussionId: '$!{discussionId}',
            messageId: '$!{messageId}',
            onPDAPortal: $!{onPDAPortal}
        }
    };
    
</script>
${sakaiHtmlHead}
<link rel="stylesheet" type="text/css" href="/yaft-tool/js/jquery-ui/css/smoothness/jquery-ui-1.10.4.custom.min.css" />
<link rel="stylesheet" type="text/css" href="/profile2-tool/css/profile2-profile-entity.css" media="all" />
<link rel="stylesheet" type="text/css" href="/yaft-tool/css/yaft.css" />
<script type="text/javascript" src="/yaft-tool/js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="/yaft-tool/js/jquery-ui-1.10.4.custom.min.js"></script>
<script type="text/javascript" src="/yaft-tool/js/jquery.cluetip.min.js"></script>
<script type="text/javascript" src="/yaft-tool/js/jquery.hoverIntent.minified.js"></script>
<script type="text/javascript" src="/yaft-tool/js/jquery.MultiFile.pack.js"></script>
<script type="text/javascript" src="/yaft-tool/js/jquery.tablesorter.min.js"></script>
<script type="text/javascript" src="/yaft-tool/js/jquery.form.min.js"></script>
<script type="text/javascript" src="/yaft-tool/js/trimpath-template-latest.js"></script>
<script type="text/javascript" src="/yaft-tool/js/handlebars.runtime-v1.3.0.js"></script>

<!-- HANDLEBARS TEMPLATES -->
<script type="text/javascript" src="/yaft-tool/templates/toolbar.handlebars"></script>
<script type="text/javascript" src="/yaft-tool/templates/forum_breadcrumb.handlebars"></script>
<script type="text/javascript" src="/yaft-tool/templates/move_discussion_breadcrumb.handlebars"></script>
<script type="text/javascript" src="/yaft-tool/templates/start_discussion_breadcrumb.handlebars"></script>
<script type="text/javascript" src="/yaft-tool/templates/permissions_breadcrumb.handlebars"></script>
<script type="text/javascript" src="/yaft-tool/templates/discussion_breadcrumb.handlebars"></script>
<script type="text/javascript" src="/yaft-tool/templates/edit_forum_breadcrumb.handlebars"></script>
<script type="text/javascript" src="/yaft-tool/templates/message_view_breadcrumb.handlebars"></script>
<script type="text/javascript" src="/yaft-tool/templates/edit_message_breadcrumb.handlebars"></script>
<script type="text/javascript" src="/yaft-tool/templates/forums.handlebars"></script>
<script type="text/javascript" src="/yaft-tool/templates/forum.handlebars"></script>

<script type="text/javascript" src="/yaft-tool/js/sakaiutils.js"></script>
<script type="text/javascript" src="/yaft-tool/js/yaftpermissions.js"></script>
<script type="text/javascript" src="/yaft-tool/js/yaftutils.js"></script>
<script type="text/javascript" src="/profile2-tool/javascript/profile2-eb.js"></script>
<script type="text/javascript" src="/yaft-tool/yaft-translations-en_GB.js"></script>
<script type="text/javascript" src="/yaft-tool/yaft-translations-${isoLanguage}.js"></script>
</head>
<body>

<div class="portletBody">

<ul id="yaft_toolbar" class="navIntraTool actionToolBar" role="menu"></ul>

<br />
<div id="yaft_container">
    <div id="yaft_breadcrumb"></div>
    <br />
    <div id="yaft_feedback_message"></div>
    <br />
    <div id="yaft_content"></div>
</div>

<!--  Templates Start -->

<div id="yaft_move_discussion_content_template" style="display:none"><!--
    <span><b>${yaft.translations.move_discussion_instruction_one}'${discussion.subject}'${yaft.translations.move_discussion_instruction_two}</b></span>
    <br />
    <br />
    <span>${yaft.translations.move_discussion_instruction_three}</span>
    <br />
    <br />
    <form id="yaft_move_discussion_form" action="/portal/tool/${yaft.startupArgs.placementId}" method="POST">
        <input type="hidden" name="function" value="moveDiscussion"/>
        <input type="hidden" name="discussionId" value="${discussion.id}"/>
        <input type="hidden" name="currentForumId" value="${discussion.forumId}"/>
        <select name="forumId">
        {for forum in forums}
            {if forum.id != yaft.currentForum.id}<option value="${forum.id}">${forum.title}</option>{/if}
        {/for}
        </select>
        <br />
        <br />
        <input type="submit" value="${yaft.translations.move_label}"/>
        <input type="button" value="${yaft.translations.cancel_label}" onClick="return yaft.switchState('forum');"/>
    </form>
-->
</div>

<div id="yaft_start_discussion_content_template" style="display:none;"><!--
<div id="yaft_reply_container">
    <form id="yaft_discussion_form" method="POST" action="/portal/tool/${yaft.startupArgs.placementId}/discussions">
        <input type="hidden" name="id" value="${discussion.id}"/>
        <input type="hidden" name="forumId" value="${yaft.currentForum.id}"/>
        <input type="hidden" name="siteId" value="${yaft.startupArgs.siteId}"/>
        <h4>${yaft.translations.type_your_message_label}</h4>
        <br />
        <span>${yaft.translations.subject_label}: *</span>
        <br />
        <input id="yaft_subject_field" name="subject" type="text" size="48" value="${discussion.subject}"/>
        <br />
        <br />
        <span>${yaft.translations.message_label}: *</span>
        <br />
        <textarea name="content" id="yaft_discussion_editor" cols="100" rows="5">${discussion.firstMessage.content}</textarea>
        <br />
        <br />
        {if yaft.currentUserPermissions.sendAlerts}
        <input type="checkbox" id="yaft_send_email_checkbox" name="sendEmail" value="true" checked/>${yaft.translations.send_email_alert_label}
        <br />
        <br />
        {/if}
        <input type="checkbox" id="yaft_allow_anonymous_posting_checkbox" name="allowAnonymousPosting" value="true" />${yaft.translations.allow_anonymous_posting_label}
        <br />
        <br />
        <span>${yaft.translations.add_attachments_label}</span>
        <br />
        <input id="yaft_attachment" name="attachment" type="file" class="multi"/><br clear="all"/>
    
{if !discussion.groupsInherited && groups.length > 0}
<a id="yaft_toggle_group_options_link" href="javascript:;">Groups</a>
<br />
<div id="yaft_group_options" style="display:none;">
    <fieldset id="yaft_groups_fieldset">
        <legend>${yaft.translations.groups_box_label}</legend>
        <span class="instruction">${yaft.translations.limit_discussion_to_groups_label}</span>
        <br />
        <br />
        {for group in groups}
        <input type="checkbox" id="${group.id}" class="yaft_group_checkbox" name="groups" value="${group.id}"/>${group.title}
        <br />
        {/for}
    </fieldset>
    <br />
</div>
{/if}
<br />
<a id="yaft_toggle_availability_options_link" href="javascript:;">${yaft.translations.availability_label}</a>
<br />
<div id="yaft_availability_options" style="display:none;">
    <fieldset id="yaft_availability_fieldset">
        <legend>${yaft.translations.availability_label}</legend>
        <input type="checkbox" id="yaft_lock_writing_checkbox" onclick="if($('#yaft_lock_reading_checkbox').attr('checked')) return false;" name="lockWriting" value="true"/>${yaft.translations.availability_lock_for_writing_label}
        <br />
        <input type="checkbox" id="yaft_lock_reading_checkbox" onclick="$('#yaft_lock_writing_checkbox').attr('checked',true);" name="lockReading" value="true"/>${yaft.translations.availability_lock_for_reading_label}
        <br />
        <br />
        <input type="hidden" name="startDate" id="yaft_start_date_millis"/>
        <input type="hidden" name="endDate" id="yaft_end_date_millis"/>
        <span>${yaft.translations.availability_except_between_label}</span>
        <br />
        <br />
        <input id="yaft_start_date" type="text"/>
        <select id="yaft_start_hours">
                <option>00</option>
                <option>01</option>
                <option>02</option>
                <option>03</option>
                <option>04</option>
                <option>05</option>
                <option>06</option>
                <option>07</option>
                <option>08</option>
                <option>09</option>
                <option>10</option>
                <option>11</option>
                <option>12</option>
                <option>13</option>
                <option>14</option>
                <option>15</option>
                <option>16</option>
                <option>17</option>
                <option>18</option>
                <option>19</option>
                <option>20</option>
                <option>21</option>
                <option>22</option>
                <option>23</option>
                </select> : <select id="yaft_start_minutes">
                            <option>00</option>
                            <option>15</option>
                            <option>30</option>
                            <option>45</option>
                        </select>
                        <br />
                        <br />
        <span>${yaft.translations.availability_except_between_and_label}</span>
        <br />
        <br />
        <input id="yaft_end_date" type="text"/>
        <select id="yaft_end_hours">
                <option>00</option>
                <option>01</option>
                <option>02</option>
                <option>03</option>
                <option>04</option>
                <option>05</option>
                <option>06</option>
                <option>07</option>
                <option>08</option>
                <option>09</option>
                <option>10</option>
                <option>11</option>
                <option>12</option>
                <option>13</option>
                <option>14</option>
                <option>15</option>
                <option>16</option>
                <option>17</option>
                <option>18</option>
                <option>19</option>
                <option>20</option>
                <option>21</option>
                <option>22</option>
                <option>23</option>
        </select> : <select id="yaft_end_minutes">
                            <option>00</option>
                            <option>15</option>
                            <option>30</option>
                            <option>45</option>
                        </select>
        <br />
        <br />
        <a href="#" onclick="yaft.utils.clearDates();">${yaft.translations.availability_clear_date_label}</a>
    </fieldset>
    <br />
</div>

<br />

{if yaft.gradebookAssignments && yaft.gradebookAssignments.length > 0 }
<a id="yaft_toggle_gradebook_options_link" href="javascript:;">${yaft.translations.grading_label}</a>
<br />
<div id="yaft_gradebook_options" style="display:none;">
    <fieldset id="yaft_grading_fieldset" style="display: none;">
        <legend>${yaft.translations.grading_label}</legend>
        <input id="yaft_grade_checkbox" type="checkbox" name="grade" value="true"/>${yaft.translations.grading_message}
        <br />
        <select id="yaft_assignment_selector" class="indnt4" name="assignmentId" style="display: none;">
        {for gbAssignment in yaft.gradebookAssignments}
        <option value="${gbAssignment.id}">${gbAssignment.name}</option>
        {/for}
        </select>
    </fieldset>
    <br />
</div>
{/if}
<br />
    
        <input type="submit" value="${yaft.translations.save_label}"/>
        <input type="button" value="${yaft.translations.cancel_label}" onClick="return yaft.switchState('forum');"/>
    
    </form>
</div>
-->
</div>

<div id="yaft_permissions_content_template" style="display:none"><!--
<form>
<table id="yaft_permissions_table">
    <thead>
        <tr>
            <th></th>
            <th width="5px"></th>
            <th align="center" colspan="4">${yaft.translations.forum_label}</th>
            <th width="5px"></th>
            <th colspan="4">${yaft.translations.discussion_label}</th>
            <th width="5px"></th>
            <th colspan="3">${yaft.translations.message_label}</th>
            <th width="5px"></th>
            <th colspan="2">${yaft.translations.other_label}</th>
        </tr>
        <tr class="listHier">
            <th align="left">${yaft.translations.role_label}</th>
            <th style="background: white;"></th>
            <th style="text-align:center;">${yaft.translations.permissions_create}</th>
            <th style="text-align:center;">${yaft.translations.permissions_delete_own}</th>
            <th style="text-align:center;">${yaft.translations.permissions_delete_any}</th>
            <th style="text-align:center;">${yaft.translations.permissions_view_groups}</th>
            <th style="background: white;"></th>
            <th style="text-align:center;">${yaft.translations.permissions_create}</th>
            <th style="text-align:center;">${yaft.translations.permissions_delete_own}</th>
            <th style="text-align:center;">${yaft.translations.permissions_delete_any}</th>
            <th style="text-align:center;">${yaft.translations.permissions_view_anonymous}</th>
            <th style="background: white;"></th>
            <th style="text-align:center;">${yaft.translations.permissions_create}</th>
            <th style="text-align:center;">${yaft.translations.permissions_delete_own}</th>
            <th style="text-align:center;">${yaft.translations.permissions_delete_any}</th>
            <th style="background: white;"></th>
            <th style="text-align:center;">${yaft.translations.permissions_view_invisible}</th>
            <th style="text-align:center;">${yaft.translations.permissions_modify_permissions}</th>
            <th style="text-align:center;">sendAlerts</th>
        </tr>
    </thead>
<tbody>
{for p in perms}
<tr>
    <td align="left">${p.role}</td>
    <td></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_forum_create}checked="checked"{/if}" id="${p.role}:yaft.forum.create"/></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_forum_deleteOwn}checked="checked"{/if}" id="${p.role}:yaft.forum.deleteOwn"/></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_forum_deleteAny}checked="checked"{/if}" id="${p.role}:yaft.forum.deleteAny"/></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_forum_viewGroups}checked="checked"{/if}" id="${p.role}:yaft.forum.viewGroups"/></td>
    <td></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_discussion_create}checked="checked"{/if}" id="${p.role}:yaft.discussion.create"/></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_discussion_deleteOwn}checked="checked"{/if}" id="${p.role}:yaft.discussion.deleteOwn"/></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_discussion_deleteAny}checked="checked"{/if}" id="${p.role}:yaft.discussion.deleteAny"/></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_discussion_viewAnonymous}checked="checked"{/if}" id="${p.role}:yaft.discussion.viewAnonymous"/></td>
    <td></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_message_create}checked="checked"{/if}" id="${p.role}:yaft.message.create"/></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_message_deleteOwn}checked="checked"{/if}" id="${p.role}:yaft.message.deleteOwn"/></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_message_deleteAny}checked="checked"{/if}" id="${p.role}:yaft.message.deleteAny"/></td>
    <td></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_view_invisible}checked="checked"{/if}" id="${p.role}:yaft.view.invisible"/></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_modify_permissions}checked="checked"{/if}" id="${p.role}:yaft.modify.permissions"/></td>
    <td align="center"><input type="checkbox" class="yaft_permission_checkbox" {if p.yaft_sendAlerts}checked="checked"{/if}" id="${p.role}:yaft.sendAlerts"/></td>
</tr>
{/for}
</tbody>
</table>
<input id="yaft_permissions_save_button" type="button" value="${yaft.translations.save_label}"/>
<input type="button" value="${yaft.translations.cancel_label}" onclick="return yaft.switchState('forums');"/>
</form>
-->
</div>

<div id="yaft_message_template" style="display:none"><!--
    {if !read}
        <div class="yaft_unread_wrapper">
    {/if}
    {if status == 'DELETED'}
        {if yaft.currentUserPermissions.messageDeleteAny}
            <div class="yaft_message yaft_deleted_message">
        {/if}
    {else}
        <div class="yaft_message">
    {/if}
        
    {if (status != 'DELETED') || (status == 'DELETED' && yaft.currentUserPermissions.messageDeleteAny)}
        <div style="margin:5px;overflow:hidden;">
            {if anonymous}
                {if creatorId == yaft.startupArgs.userId || yaft.currentUserPermissions.discussionViewAnonymous}
                <a href="javascript:;" class="profile" rel="/direct/profile/${creatorId}/formatted"><img class="yaft_profile_image" src="/direct/profile/${creatorId}/image" width="35"/></a>
                {else}
                <img class="yaft_profile_image" src="/direct/profile/blank/image" width="35" />
                {/if}
            {else}
                <a href="javascript:;" class="profile" rel="/direct/profile/${creatorId}/formatted"><img class="yaft_profile_image" src="/direct/profile/${creatorId}/image" width="35"/></a>
            {/if}
            <div style="margin-left:2px;overflow: hidden;">
                <div style="float:left;">
                    <a id="message-${id}" name="message-${id}" href="${url}"><span style="font-weight: bold">${subject}</span></a>{if anonymous && (creatorId == yaft.startupArgs.userId || yaft.currentUserPermissions.discussionViewAnonymous)}<span class="yaft_small_graded_in_label"> - ${yaft.translations.anonymous_label}</span>{/if}
                    <br/>
                    {if anonymous}
                        {if creatorId == yaft.startupArgs.userId || yaft.currentUserPermissions.discussionViewAnonymous}
                        <span>by <a href="javascript:;" class="profile" rel="/direct/profile/${creatorId}/formatted">${creatorDisplayName}</a> - ${formattedDate}</span>
                        {else}
                        <span>by ${creatorDisplayName} - ${formattedDate}</span>
                        {/if}
                    {else}
                        <span>by <a href="javascript:;" class="profile" rel="/direct/profile/${creatorId}/formatted">${creatorDisplayName}</a> - <span>${formattedDate}</span>
                    {/if}
                </div>
                <div style="float: right;">
                    {if attachments.length > 0}
                    <span>${yaft.translations.attachments_label}</span>
                    {/if}
                    {for attachment in attachments}
                        <a onclick="window.open('${attachment.url}');" title="${attachment.name}">
                        {if attachment.mimeType == 'application/pdf'}<img src="/library/image/silk/page_white_acrobat.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType.match(/excel$/)}<img src="/library/image/silk/page_white_excel.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'}<img src="/library/image/silk/page_white_excel.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType == 'application/msword' || attachment.name.match(/\.docx?$/)}<img src="/library/image/silk/page_white_word.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType.match(/powerpoint/)}<img src="/library/image/silk/page_white_powerpoint.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'}<img src="/library/image/silk/page_white_powerpoint.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType == 'text/plain'}<img src="/library/image/silk/page_white_text.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType == 'text/html'}<img src="/library/image/silk/html.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType.match(/^image/)}<img src="/library/image/silk/picture.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType.match(/^audio/)}<img src="/library/image/silk/sound.png" width="16" height="16" alt="${attachment.name}" />
                        {else}<img src="/library/image/silk/error.png" width="16" height="16" alt="${attachment.name}" />
                        {/if}
                        </a>
                    {/for}
                </div>
            </div>
            <hr style="clear: left"/>
            <div style="clear: left">${content}</div>
            <br />
            <div>
                {if yaft.startupArgs.userId == creatorId && yaft.currentUserPermissions.messageDeleteOwn}<span><a href="#" onClick="return yaft.switchState('editMessage',{'messageId':'${id}'});">${yaft.translations.edit_label}</a></span>{/if}
                {if yaft.currentUserPermissions.messageCreate && status == 'READY'}
                    <span><a href="#" onClick="return yaft.switchState('reply',{'messageBeingRepliedTo':'${id}'});">${yaft.translations.reply_label}</a></span>
                {/if}
                {if parent && 'DELETED' != status && ( (yaft.currentUserPermissions.messageDeleteOwn && yaft.startupArgs.userId == creatorId) || yaft.currentUserPermissions.messageDeleteAny)}<span><a href="#" onClick="return yaft.utils.deleteMessage('${id}');">${yaft.translations.delete_label}</a></span>{/if}
                {if status == 'DELETED' && yaft.currentUserPermissions.messageDeleteAny}<span><a href="#" onclick="return yaft.utils.undeleteMessage('${id}');">${yaft.translations.undelete_label}</a></span>{/if}
                {if children.length > 0 && yaft.startupArgs.viewMode != 'minimal'}<span><a class="yaft_collapse_expand_link" href="#" onclick="yaft.utils.toggleMessage(this,'${id}');">${yaft.translations.collapse_label}</a></span>{/if}
                {if yaft.startupArgs.userId != creatorId}
                {if defined('read') && read == true}
                    <span><a href="javascript:;" onClick="return yaft.utils.markMessageRead(yaft.utils.findMessage('${id}'),false);">${yaft.translations.mark_message_unread_label}</a></span>
                {else}
                    <span><a href="#" onClick="return yaft.utils.markMessageRead(yaft.utils.findMessage('${id}'),true);">${yaft.translations.mark_message_read_label}</a></span>
                {/if}
                {/if}
            </div>
        </div>
        </div>
    {/if}
    {if !read}
        </div>
    {/if}
-->
</div>

<div id="yaft_discussion_content_template" style="display:none"><!--
    {if lockedForReadingAndUnavailable && !yaft.currentUserPermissions.viewInvisible && creatorId != yaft.startupArgs.userId}
    <h3>This discussion is not available at this time</h3>
    {elseif 'DELETED' == status}
    <h3>This discussion has been deleted</h3>
    {else}
    <a href="#" onClick="return yaft.utils.markCurrentDiscussionRead(true);">${yaft.translations.mark_discussion_read_label}</a>
    <br />
    <br />

    {macro display(message)}
        <div id="${message.id}" style="overflow: auto;">
        </div>
        <div class="yaft_messages">
        {for child in message.children}
            ${D}{display(child)}
        {/for}
        </div>
    {/macro}
    
    ${D}{display(firstMessage)}
    
    <br />
    
    <a href="#" onClick="return yaft.utils.markCurrentDiscussionRead(true);">${yaft.translations.mark_discussion_read_label}</a>
    {/if}
-->
</div>

<div id="yaft_edit_forum_content_template" style="display:none;"><!--
<div>
<span class="instruction">
    ${yaft.translations.create_forum_instruction}
</span>
<br />
<br />
</div>
<div id="yaft_edit_forum_container">
<form>
<input id="yaft_id_field" type="hidden" name="id" value="${forum.id}"/>
<table>
<tr><td>${yaft.translations.forum_title_label}: *</td><td><input id="yaft_title_field" type="text" name="title" value="${forum.title}"/></td></tr>
<tr><td>${yaft.translations.description_label}</td><td><input id="yaft_description_field" type="text" name="description" maxlength="255" value="${forum.description}"/></td></tr>
</table>
<br />
{if yaft.currentUserPermissions.sendAlerts}
<input type="checkbox" id="yaft_send_email_checkbox" value="true" checked/>${yaft.translations.send_email_alert_label}
<br />
<br />
{/if}
{if siteGroups.length > 0}
<a id="yaft_toggle_group_options_link" href="javascript:;">${yaft.translations.groups_box_label}</a>
<br />
<div id="yaft_group_options" style="display:none;">
    <fieldset id="yaft_groups_fieldset">
    <legend>${yaft.translations.groups_box_label}</legend>
    <span class="instruction">${yaft.translations.limit_forum_to_groups_label}</span>
    <br />
    <br />
    {for siteGroup in siteGroups}
    <input type="checkbox" class="yaft_group_checkbox" id="${siteGroup.id}" value="${siteGroup.title}"/>${siteGroup.title}
    <br />
    {/for}
    </fieldset>
</div>
<br />
{/if}

<a id="yaft_toggle_availability_options_link" href="javascript:;">${yaft.translations.availability_label}</a>
<br />
<div id="yaft_availability_options" style="display:none;">
    <fieldset id="yaft_availability_fieldset">
    <legend>${yaft.translations.availability_label}</legend>
    <input type="checkbox" id="yaft_lock_writing_checkbox" onclick="if($('#yaft_lock_reading_checkbox').attr('checked')) return false;" name="lockWriting" value="true"/>${yaft.translations.availability_lock_for_writing_label}
    <br />
    <input type="checkbox" id="yaft_lock_reading_checkbox" onclick="$('#yaft_lock_writing_checkbox').attr('checked',true);" name="lockReading" value="true"/>${yaft.translations.availability_lock_for_reading_label}
    <br />
    <br />
    <input type="hidden" name="startDate" id="yaft_start_date_millis"/>
    <input type="hidden" name="endDate" id="yaft_end_date_millis"/>
    <span>${yaft.translations.availability_except_between_label}</span>
    <br />
    <br />
    <input id="yaft_start_date" type="text" name="startDate"/>
    <select id="yaft_start_hours" name="startHour">
            <option>00</option>
            <option>01</option>
            <option>02</option>
            <option>03</option>
            <option>04</option>
            <option>05</option>
            <option>06</option>
            <option>07</option>
            <option>08</option>
            <option>09</option>
            <option>10</option>
            <option>11</option>
            <option>12</option>
            <option>13</option>
            <option>14</option>
            <option>15</option>
            <option>16</option>
            <option>17</option>
            <option>18</option>
            <option>19</option>
            <option>20</option>
            <option>21</option>
            <option>22</option>
            <option>23</option>
            </select> : <select id="yaft_start_minutes" name="startMinute">
                        <option>00</option>
                        <option>15</option>
                        <option>30</option>
                        <option>45</option>
                    </select>
    <br />
                    <br />
    <span>${yaft.translations.availability_except_between_and_label}</span>
    <br />
    <br />
    <input id="yaft_end_date" type="text" name="endDate"/>
    <select id="yaft_end_hours" name="endHour">
            <option>00</option>
            <option>01</option>
            <option>02</option>
            <option>03</option>
            <option>04</option>
            <option>05</option>
            <option>06</option>
            <option>07</option>
            <option>08</option>
            <option>09</option>
            <option>10</option>
            <option>11</option>
            <option>12</option>
            <option>13</option>
            <option>14</option>
            <option>15</option>
            <option>16</option>
            <option>17</option>
            <option>18</option>
            <option>19</option>
            <option>20</option>
            <option>21</option>
            <option>22</option>
            <option>23</option>
        </select> : <select id="yaft_end_minutes" name="endMinute">
                        <option>00</option>
                        <option>15</option>
                        <option>30</option>
                        <option>45</option>
                    </select>
    <br />
    <br />
    <a href="#" onclick="yaft.utils.clearDates();">${yaft.translations.availability_clear_date_label}</a>
    </fieldset>
    <br />
</div>

<br />
<br />
<input type="button" id="yaft_forum_save_button" value="${yaft.translations.save_label}"/>
<input type="button" value="${yaft.translations.cancel_label}" onclick="return yaft.switchState('forums');"/>
</form>
</div>
-->
</div>

<div id="yaft_message_view_content_template" style="display:none"><!--
    {if lockedForReadingAndUnavailable && !yaft.currentUserPermissions.viewInvisible && creatorId != yaft.startupArgs.userId}
    <h3>This discussion is not available at this time</h3>
    {elseif 'DELETED' == status}
    <h3>This discussion has been deleted</h3>
    {else}
    <a href="#" onClick="return yaft.utils.markCurrentDiscussionRead(true);"${yaft.translations.mark_discussion_read_label}</a>
    <br />
    <br />

    {macro displayMinimum(message)}
        {if message.status == 'READY'}
            <div id="${message.id}_link" class="yaft_message_minimised">
                <a href="#" title="Click to show the full message" onclick="yaft.showMessage('${message.id}')"><span style="font-weight: bold">${message.subject}</span></a></span> - <span>by 
                {if message.anonymous}
                    {if message.creatorId == yaft.startupArgs.userId || yaft.currentUserPermissions.discussionViewAnonymous}
                    <a href="javascript:;" class="profile" rel="/direct/profile/${message.creatorId}/formatted">${message.creatorDisplayName}</a></span> at <span>${message.formattedDate}</span>
                    {else}
                    ${yaft.translations.anonymous_label}</span> at <span>${message.formattedDate}</span>
                    {/if}
                {else}
                    <a href="javascript:;" class="profile" rel="/direct/profile/${message.creatorId}/formatted">${message.creatorDisplayName}</a></span> at <span>${message.formattedDate}</span>
                {/if}
                <img title="You've read this message" {if !message.read} style="display:none"{/if} class="messageReadFlag" id="${message.id}_read" src="/library/image/silk/book_open.png" width="16" height="16"/>
                {for attachment in message.attachments}
                    <a onclick="window.open('${attachment.url}');" title="${attachment.name}">
                    {if attachment.mimeType == 'application/pdf'}<img src="/library/image/silk/page_white_acrobat.png" width="16" height="16" alt="${attachment.name}" />
                    {elseif attachment.mimeType.match(/excel$/)}<img src="/library/image/silk/page_white_excel.png" width="16" height="16" alt="${attachment.name}" />
                    {elseif attachment.mimeType == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'}<img src="/library/image/silk/page_white_excel.png" width="16" height="16" alt="${attachment.name}" />
                    {elseif attachment.mimeType == 'application/msword' || attachment.name.match(/\.docx?$/)}<img src="/library/image/silk/page_white_word.png" width="16" height="16" alt="${attachment.name}" />
                    {elseif attachment.mimeType.match(/powerpoint/)}<img src="/library/image/silk/page_white_powerpoint.png" width="16" height="16" alt="${attachment.name}" />
                    {elseif attachment.mimeType == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'}<img src="/library/image/silk/page_white_powerpoint.png" width="16" height="16" alt="${attachment.name}" />
                    {elseif attachment.mimeType == 'text/plain'}<img src="/library/image/silk/page_white_text.png" width="16" height="16" alt="${attachment.name}" />
                    {elseif attachment.mimeType == 'text/html'}<img src="/library/image/silk/html.png" width="16" height="16" alt="${attachment.name}" />
                    {elseif attachment.mimeType.match(/^image/)}<img src="/library/image/silk/picture.png" width="16" height="16" alt="${attachment.name}" />
                    {elseif attachment.mimeType.match(/^audio/)}<img src="/library/image/silk/sound.png" width="16" height="16" alt="${attachment.name}" />
                    {else}<img src="/library/image/silk/error.png" width="16" height="16" alt="${attachment.name}" />
                    {/if}
                    </a>
                {/for}
                {if message.parent && 'DELETED' != message.status && ( (yaft.currentUserPermissions.messageDeleteOwn && yaft.startupArgs.userId == message.creatorId) || yaft.currentUserPermissions.messageDeleteAny)}<span><a href="#" onClick="return yaft.utils.deleteMessage('${message.id}');">${yaft.translations.delete_label}</a></span>{/if}
            </div>
            <div class="yaft_full_message" id="${message.id}" style="display: none;overflow: auto;margin-top:5px;"></div>
        {/if}
        
        <div class="yaft_messages">
        {for child in message.children}
            {if message.status == 'DELETED'}
                ${D}{displayMinimum(child)}
            {else}
                ${D}{displayMinimum(child)}
            {/if}
        {/for}
        </div>
    {/macro}
    
    ${D}{displayMinimum(firstMessage)}
    {/if}
-->
</div>

<div id="yaft_reply_message_content_template" style="display:none;"><!--
<div style="border: solid black 1px;" class="yaft_message">
    <div style="margin:5px;overflow:auto;">
        <img style="float:left;margin-right:2px;" src="/direct/profile/${creatorId}/image" width="35" height="35"/>
        <div style="margin-left:2px;overflow: auto;">
            <div style="float:left;">
                <span style="font-weight: bold">${subject}</span>
                <br/>
                <span>by ${creatorDisplayName}</span> - <span>${formattedDate}</span>
            </div>
        </div>
        <hr style="clear: left"/>
        <div style="clear: left">${content}</div>
    </div>
</div>
<br />
<div id="yaft_reply_container">
    <form id="yaft_message_form" onSubmit="return yaft.utils.validateMessageSubmission('${D}{escape(subject)}');" action="/portal/tool/${yaft.startupArgs.placementId}/messages" method="POST">
    <h4>${yaft.translations.type_your_message_label}</h4>
    <br />
    <span>${yaft.translations.subject_label}: *</span>
    <br />
    <input id="yaft_message_subject_field" name="subject" type="text" size="48"/>
    <br />
    <br />
    <span>${yaft.translations.message_label}: *</span>
    <br />
    <textarea name="content" id="yaft_message_editor" cols="100" rows="5"></textarea>
    <br />
    <br />
    {if yaft.currentUserPermissions.sendAlerts}
    <input type="checkbox" id="yaft_send_email_checkbox" value="true" name="sendEmail" value="true" checked/>${yaft.translations.send_email_alert_label}
    <br />
    <br />
    {/if}
    <span>${yaft.translations.add_attachments_label}</span>
    <br />
    <input id="yaft_attachment" name="attachment" type="file" class="multi"/>
    <br/>

    <input type="hidden" name="function" value="createMessage"/>
    <input id="yaft_anonymous_flag" type="hidden" name="anonymous" value="false" />
    <input type="hidden" name="forumId" value="${yaft.currentForum.id}"/>
    <input type="hidden" name="siteId" value="${yaft.startupArgs.siteId}"/>
    <input type="hidden" name="discussionId" value="${yaft.currentDiscussion.id}"/>
    <input type="hidden" name="messageBeingRepliedTo" value="${id}"/>
    <input type="hidden" name="viewMode" value="${yaft.startupArgs.viewMode}"/>
    <input id="yaft_message_status_field" type="hidden" name="status" value="READY"/>
    
    <input type="submit" value="${yaft.translations.publish_label}"/>
    {if yaft.currentDiscussion.allowAnonymousPosting}
    <input type="button" id="yaft_publish_anonymously_button" value="${yaft.translations.publish_anonymously_label}"/>
    {/if}
    <input type="button" value="${yaft.translations.cancel_label}" onclick="return yaft.switchState('${yaft.startupArgs.viewMode}',{'messageId':'${id}'})"/>
    
    </form>
</div>
-->
</div>

<div id="yaft_edit_message_content_template" style="display:none;"><!--
<div id="yaft_reply_container">
    <form id="yaft_message_form" method="POST" action="/portal/tool/${yaft.startupArgs.placementId}/messages">
    <h4>Type your message</h4>
    <br />
    <span>${yaft.translations.subject_label}</span>
    <br />
    <input name="subject" type="text" size="48" value="${subject}"/>
    <br />
    <br />
    <span>${yaft.translations.message_label}: *</span>
    <br />
    <textarea name="content" id="yaft_message_editor" cols="100" rows="5">${content}</textarea>
    <br />
    <br />
    {if yaft.currentUserPermissions.sendAlerts}
    <input type="checkbox" id="yaft_send_email_checkbox" name="sendEmail" value="true" checked/>${yaft.translations.send_email_alert_label}
    <br />
    <br />
    {/if}
    <span id="current_attachments_label">${yaft.translations.current_attachments_label}</span>
    <br />
    <br />
    {for attachment in attachments}
        {if attachment.name != 'array'}
            <div id="file_${attachment_index}">
                <span>${attachment.name}</span>
                <a href="#" onclick="yaft.utils.removeAttachment('${attachment.resourceId}','${id}','file_${attachment_index}');" title="Delete attachment"><img src="/library/image/silk/cross.png" width="16" height="16"/></a>
                <br />
            </div>
        {/if}
    {/for}
    <br />

    <span>${yaft.translations.add_attachments_label}</span>
    <br />
    <input id="yaft_attachment" name="attachment" type="file" class="multi"/>
    <br/>

    <input type="submit" value="${yaft.translations.save_label}"/>
    <input type="button" value="${yaft.translations.cancel_label}" onclick="return yaft.switchState('${yaft.startupArgs.viewMode}',{'messageId':'${id}'})"/>

    <input type="hidden" name="forumId" value="${yaft.currentForum.id}"/>
    <input type="hidden" name="siteId" value="${yaft.startupArgs.siteId}"/>
    <input type="hidden" name="discussionId" value="${yaft.currentDiscussion.id}"/>
    <input type="hidden" name="messageId" value="${id}"/>
    <input type="hidden" name="viewMode" value="${yaft.startupArgs.viewMode}"/>
    </form>
</div>
-->
</div>

<div id="yaft_authors_template" style="display:none;"><!--
<table id="yaft_author_table" class="listHier">
    <thead>
        <tr><th>${yaft.translations.name_label}</th><th>${yaft.translations.number_of_posts_label}</th>{if yaft.currentUserPermissions.gradeAll && yaft.currentDiscussion.graded}<th>${yaft.translations.grade_label}</th>{/if}</tr>
    </thead>
    <tbody>
        {for author in authors}
            <tr><td><a class="profile" rel="/direct/profile/${author.id}/formatted" href="javascript:;" onClick="yaft.switchState('author',{'id':'${author.id}','displayName':'${author.displayName}'});">${author.displayName}</a></td><td>${author.numberOfPosts}</td>{if yaft.currentDiscussion.graded}<td>{if author.graded}${author.grade.grade}{/if}</td>{/if}</tr>
        {/for}
    </tbody>
</table>
-->
</div>

<div id="yaft_discussion_authors_breadcrumb_template" style="display:none;"><!--
    <a href="/portal/tool/${yaft.startupArgs.placementId}/forums" onClick="return yaft.switchState('forums');">${yaft.translations.forums_label}</a>-&gt;<a href="${yaft.currentForum.url}" onClick="return yaft.switchState('forum',{'forumId':'${yaft.currentForum.id}'});">${yaft.currentForum.title}</a>-&gt;<a href="${yaft.currentDiscussion.url}" onClick="return yaft.switchState('full',{'discussionId':'${id}'});">${subject}</a>-&gt;${yaft.translations.authors_label}
-->
</div>

<div id="yaft_author_messages_breadcrumb_template" style="display:none;"><!--
    <a href="/portal/tool/${yaft.startupArgs.placementId}/forums" onClick="return yaft.switchState('forums');">${yaft_forums_label}</a>-&gt;<a href="${yaft.currentForum.url}" onClick="return yaft.switchState('forum',{'forumId':'${yaft.currentForum.id}'});">${yaft.currentForum.title}</a>-&gt;<a href="${yaft.currentDiscussion.url}" onClick="return yaft.switchState('full',{'discussionId':'${yaft.currentDiscussion.id}'});">${yaft.currentDiscussion.subject}</a>-&gt;<a href="/portal/tool/${yaft.startupArgs.placementId}/authors" onClick="return yaft.switchState('authors');">${yaft_authors_label}</a>-&gt;<a class="profile" rel="/direct/profile/${id}/formatted" href="javascript:;">${displayName}</a>
-->
</div>

<div id="yaft_messages_template" style="display:none"><!--
    {if defined('assignment') && yaft.currentUserPermissions.gradeAll}Grade: <input type="text" class="yaft_grade_field" id="yaft_grade_field" value="${grade}"/> / ${assignment.points}&nbsp;<input type="button" id="yaft_grade_button" value="Apply Grade"/><span class="yaft_grade_success_message">Grade Updated!</span><br /><br />{/if}
    <div id="yaft_author_nav_buttons">
        <img id="yaft_previous_author_button" src="/library/image/silk/resultset_previous.png" title="${yaft.translations.previous_author_tooltip}" alt="${yaft.translations.previous_author_tooltip}"/>
        <img id="yaft_next_author_button" src="/library/image/silk/resultset_next.png" title="${yaft.translations.next_author_tooltip}" alt="${yaft.translations.next_author_tooltip}" />
        <span>${yaft.translations.messages_by} <b>${displayName}</b></span>
    </div>
    {for message in messages}
        <div class="yaft_message">
        
        <div style="margin:5px;overflow:hidden;">
            <div style="margin-left:2px;overflow: hidden;">
                <div style="float:left;">
                    <a id="message-${message.id}" href="${message.url}"><span style="font-weight: bold">${message.subject}</span></a> - <span>${message.formattedDate}</span>
                </div>
                <div style="float: right;">
                    {if message.attachments.length > 0}
                    <span>Attachments: </span>
                    <span>${yaft.translations.attachments_label}</span>
                    {/if}
                    {for attachment in message.attachments}
                        <a onclick="window.open('${attachment.url}');" title="${attachment.name}">
                        {if attachment.mimeType == 'application/pdf'}<img src="/library/image/silk/page_white_acrobat.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType.match(/excel$/)}<img src="/library/image/silk/page_white_excel.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'}<img src="/library/image/silk/page_white_excel.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType == 'application/msword' || attachment.name.match(/\.docx?$/)}<img src="/library/image/silk/page_white_word.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType.match(/powerpoint/)}<img src="/library/image/silk/page_white_powerpoint.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'}<img src="/library/image/silk/page_white_powerpoint.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType == 'text/plain'}<img src="/library/image/silk/page_white_text.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType == 'text/html'}<img src="/library/image/silk/html.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType.match(/^image/)}<img src="/library/image/silk/picture.png" width="16" height="16" alt="${attachment.name}" />
                        {elseif attachment.mimeType.match(/^audio/)}<img src="/library/image/silk/sound.png" width="16" height="16" alt="${attachment.name}" />
                        {else}<img src="/library/image/silk/error.png" width="16" height="16" alt="${attachment.name}" />
                        {/if}
                        </a>
                    {/for}
                </div>
            </div>
            <hr style="clear: left"/>
            <div style="clear: left">${message.content}</div>
            <br />
        </div>
        </div>
    {/for}
    {if defined('assignment') && yaft.currentUserPermissions.gradeAll}Grade: <input type="text" class="yaft_grade_field" id="yaft_grade_field2" value="${grade}"/> / ${assignment.points}&nbsp;<input type="button" id="yaft_grade_button2" value="Apply Grade"/><span class="yaft_grade_success_message">Grade Updated!</span><br /><br />{/if}
-->
</div>

<!--  Templates End -->

</div> <!-- /portletBody-->

<script type="text/javascript" src="/yaft-tool/js/yaft.js"></script>
<link rel="stylesheet" type="text/css" href="/yaft-tool/css/jquery.cluetip.css" />

</body>
</html>
